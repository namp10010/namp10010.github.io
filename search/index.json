[{"content":" AI is the new electricity â€” Unknown\n ","href":"/","title":"Home"},{"content":"","href":"/docs/","title":"Blog"},{"content":"In this quick tutorial, we will automate the deployment of Hugo generated static web contents to a github page using github action.\nPrerequisites   A main repo blog which is a Hugo web repo. This is where the github action will be set up\n  Generated static contents in public/ which is a git submodule which points to a github user page\ngit submodule add https://github.com/namp10010/namp10010.github.io.git public Follow Setup github user page to create your own user page.\n  Optional a theme minimo is installed under themes/minimo. (Please note I installed minimo as a clone)\n  Note Please note, this guide using main instead master as the default branch\nGithub action There are some existing github actions available for hugo deployment but they don\u0026rsquo;t do exactly what I want which is\n automatically build Hugo page deploy generated static contents to a github user page (as opposed to project page)  Therefore, I opted for a custom action\nDefine a new action in .github/actions/publisher/action.yml\nname: \u0026#34;hugo-publisher\u0026#34; description: \u0026#34;build and publish hugo pages to a remote repo\u0026#34; author: \u0026#34;namp10010\u0026#34; runs: using: \u0026#34;docker\u0026#34; image: \u0026#34;Dockerfile\u0026#34; This action will be run as a docker image built from a Dockerfile in the same directory .github/actions/publisher/Dockerfile\nFROMklakegg/hugo:0.74.3-alpineRUN apk add --no-cache git jq curlADD entrypoint.sh /RUN chmod +x /entrypoint.shENTRYPOINT [\u0026#34;/entrypoint.sh\u0026#34;]As the docker image will execute a script entrypoint.sh upon running, create this script in the same place .github/actions/publisher/entrypoint.sh\n#!/bin/sh set -e GITHUB_PAGE=\u0026#34;YOUR_GITHUB_USER_PAGE\u0026#34; GITHUB_EMAIL=\u0026#34;YOUR_EMAIL\u0026#34; GITHUB_USER=\u0026#34;YOUR_USER\u0026#34; cd ${GITHUB_WORKSPACE} hugo version || exit 1 # Clone existing pages from github page rm -rf public git clone --depth 1 https://$API_TOKEN_GITHUB@$GITHUB_PAGE public # Build the pages printf \u0026#34;\\033[0;32mBuilding static contents...\\033[0m\\n\u0026#34; hugo -t minimo # Publish printf \u0026#34;\\033[0;32mPublishing to github user page ${GITHUB_PAGE}...\\033[0m\\n\u0026#34; cd public git add . git config --global user.email $GITHUB_EMAIL git config --global user.name $GITHUB_USER msg=\u0026#34;rebuilding site $(date)\u0026#34; if [ -n \u0026#34;$*\u0026#34; ]; then msg=\u0026#34;$*\u0026#34; fi git commit -m \u0026#34;$msg\u0026#34; git push origin main Github Workflow The action is ready to use now, it just needs to be added to a workflow.\nCreate a file .github/workflows/publish.yml\nname: publish on: push: branches: - main jobs: publisher: name: publish to github page runs-on: ubuntu-latest steps: # Step 1 - Checks-out your repository under $GITHUB_WORKSPACE - name: Check out uses: actions/checkout@v2 with: submodules: true # Step 2 - run hugo-publisher - name: Run hugo-publisher uses: ./.github/actions/publisher env: API_TOKEN_GITHUB: ${{ secrets.API_TOKEN_GITHUB }} GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} Important! you will need to create an personal access token for the github action to access the github page repo. Follow Create github access token to create one for your yourgithubaccount.github.io repo. The only access scope the token will need is repo \u0026gt; public_repo.\nAdd the token to the repo\u0026rsquo;s secrets with the name API_TOKEN_GITHUB by following adding secrets to your github repo.\nNow, let make a change to your web content in repo blog and push it up to main.\nReferences  Hugo Quick Start Minimo Installation Host hugo on github Setup github user page Create github access token Add secrets to github repo  ","href":"/docs/hugo-github-action/","title":"How to auto deploy Hugo contents with Github action"},{"content":" have been doing backend APIs and a bit of DevOps interested in looking out for development in AI currently having fun with golang and GCP  ","href":"/about/","title":"About"},{"content":"","href":"/authors/","title":"Authors"},{"content":"","href":"/categories/","title":"Categories"},{"content":"","href":"/tags/github-action/","title":"github-action"},{"content":"","href":"/tags/hugo/","title":"hugo"},{"content":"","href":"/authors/namp10010/","title":"namp10010"},{"content":"","href":"/tags/","title":"Tags"},{"content":"","href":"/categories/tutorial/","title":"tutorial"},{"content":"","href":"/tags/config/","title":"Configuration"},{"content":"","href":"/tags/og/","title":"Opengraph"},{"content":"","href":"/page/","title":"Pages"},{"content":"","href":"/search/","title":"Search"},{"content":"","href":"/series/","title":"Series"}]
